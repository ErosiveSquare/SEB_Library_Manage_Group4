{% extends "base.html" %}

{% block page_title %}图书检索 / Book Search{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header-row">
        <div class="card-title">馆藏目录检索</div>
    </div>

    <form method="GET" action="{{ url_for('main.search') }}" style="display: flex; gap: 10px; margin-bottom: 30px;">
        <div class="search-wrapper" style="flex: 1; width: auto;">
            <i class="fas fa-search"></i>
            <input type="text" name="q" class="search-input" placeholder="输入书名、作者或ISBN..." value="{{ query }}">
        </div>
        <button type="submit" class="btn-glow">搜索</button>
    </form>

    <table class="clean-table">
        <thead>
            <tr>
                <th>ISBN</th>
                <th>书名 & 作者</th>
                <th>索书号</th>
                <th>出版社</th>
                <th>在馆库存</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for book in books %}
            <tr>
                <td style="font-family: monospace; color: #666;">{{ book['ISBN'] }}</td>
                <td>
                    <div style="font-weight: 600; color: #333;">{{ book['BOOK_NAME'] }}</div>
                    <div style="font-size: 12px; color: #888;">{{ book['AUTHOR'] }}</div>
                </td>
                <td><span style="background: #e2e8f0; padding: 2px 6px; border-radius: 4px; font-size: 12px;">{{ book['CALL_NUMBER'] }}</span></td>
                <td>{{ book['PUBLISHER'] }}</td>
                <td>
                    {% if book['available_count'] > 0 %}
                        <span style="color: #10b981; font-weight: bold;">{{ book['available_count'] }} 本</span>
                    {% else %}
                        <span style="color: #ef4444;">暂无库存</span>
                    {% endif %}
                </td>
                <td>
                    <button class="btn-glow" style="padding: 6px 12px; font-size: 12px; background: white; color: var(--brand-primary); border: 1px solid var(--brand-primary);">
                        查看详情
                    </button>
                </td>
            </tr>
            {% else %}
                {% if query %}
                <tr><td colspan="6" style="text-align: center; padding: 40px; color: #999;">未找到相关图书</td></tr>
                {% else %}
                <tr><td colspan="6" style="text-align: center; padding: 40px; color: #999;">请输入关键词开始检索</td></tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}